ARG BASE_IMAGE=redoubt-base:latest
FROM ${BASE_IMAGE}

# Copy actual source code
COPY crates ./crates
COPY examples ./examples
COPY forensics ./forensics

# Update timestamps to force workspace re-compilation but keep dep artifacts
RUN find crates examples forensics -type f -name "*.rs" -exec touch {} \;

CMD ["cargo", "make", "lint"]
