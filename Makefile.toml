// Copyright (c) 2025-2026 Federico Hoerth <memparanoid@gmail.com>
// SPDX-License-Identifier: GPL-3.0-only
// See LICENSE in the repository root for full license text.

# Makefile.toml
# Rust task runner (cargo-make) configuration

[config]
default_to_workspace = false

[tasks.run]
args    = ["run", "-p", "example"]
command = "cargo"

[tasks.test]
args    = ["test"]
command = "cargo"

[tasks.coverage]
dependencies = ["coverage-clean", "coverage-html"]

[tasks.coverage-clean]
args    = ["llvm-cov", "clean", "--workspace"]
command = "cargo"

[tasks.coverage-html]
args    = ["llvm-cov", "--workspace", "--html"]
command = "cargo"

[tasks.fmt-rs]
args    = ["fmt"]
command = "cargo"

[tasks.fmt-toml]
args    = ["format"]
command = "taplo"

[tasks.fmt]
dependencies = ["fmt-rs", "fmt-toml"]

[tasks.fmt-check]
args    = ["fmt", "--", "--check"]
command = "cargo"

[tasks.lint]
# Strict linting: show all warnings including rustc warnings
# Note: We don't use --all-features because it activates no_std which breaks tests
args    = ["clippy", "--workspace", "--all-targets", "--", "-W", "warnings"]
command = "cargo"

[tasks.check]
dependencies = ["fmt-check", "lint", "test"]
description  = "Run fmt, lint, and tests"
