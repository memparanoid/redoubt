// Copyright (c) 2025-2026 Federico Hoerth <memparanoid@gmail.com>
// SPDX-License-Identifier: GPL-3.0-only
// See LICENSE in the repository root for full license text.

---
source: crates/memcodec/derive/src/tests/expand.rs
assertion_line: 82
expression: pretty(token_stream)
---
impl<T> memcodec_core::BytesRequired for Container<T>
where
    T: memcodec::BytesRequired + memcodec::Encode + memcodec::Decode,
{
    fn mem_bytes_required(&self) -> Result<usize, memcodec_core::OverflowError> {
        let collection: [&dyn memcodec_core::BytesRequired; 2] = [
            memcodec_core::collections::helpers::to_bytes_required_dyn_ref(&self.value),
            memcodec_core::collections::helpers::to_bytes_required_dyn_ref(&self.count),
        ];
        memcodec_core::collections::helpers::bytes_required_sum(collection.into_iter())
    }
}
impl<T> memcodec_core::Encode for Container<T>
where
    T: memcodec::BytesRequired + memcodec::Encode + memcodec::Decode,
{
    fn encode_into(
        &mut self,
        buf: &mut memcodec_core::CodecBuffer,
    ) -> Result<(), memcodec_core::EncodeError> {
        let collection: [&mut dyn memcodec_core::EncodeZeroize; 2] = [
            memcodec_core::collections::helpers::to_encode_zeroize_dyn_mut(
                &mut self.value,
            ),
            memcodec_core::collections::helpers::to_encode_zeroize_dyn_mut(
                &mut self.count,
            ),
        ];
        memcodec_core::collections::helpers::encode_fields(collection.into_iter(), buf)
    }
}
impl<T> memcodec_core::Decode for Container<T>
where
    T: memcodec::BytesRequired + memcodec::Encode + memcodec::Decode,
{
    fn decode_from(
        &mut self,
        buf: &mut &mut [u8],
    ) -> Result<(), memcodec_core::DecodeError> {
        let collection: [&mut dyn memcodec_core::DecodeZeroize; 2] = [
            memcodec_core::collections::helpers::to_decode_zeroize_dyn_mut(
                &mut self.value,
            ),
            memcodec_core::collections::helpers::to_decode_zeroize_dyn_mut(
                &mut self.count,
            ),
        ];
        memcodec_core::collections::helpers::decode_fields(collection.into_iter(), buf)
    }
}
